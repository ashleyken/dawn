<script>

function mwApoCustom() {
  function mws_apo_hide_our_variants(selector_container, selector_items) {
    const container = document.querySelectorAll(selector_container);
    if (!container) {
      return;
    }
    for (const i of container) {
      const items = i.querySelectorAll(selector_items);
      for (let item of items) {
        if (item.textContent.indexOf("#MWS Options") >= 0) {
          item.remove();
        }
      }
      if (i.querySelectorAll(selector_items).length === 1) {
        i.style.display = "none";
      }
    }
  }

  function imageElement(id) {
    if (typeof mwApoInit.response !== "undefined") {
      for (const val of Object.values(mwApoInit.response)) {
        for (const key in val.values) {
          if (key == id) {
            if (
              typeof val.values[id].value.images !== "undefined" &&
              val.values[id].value.images.length &&
              val.values[id].value.images[1]
            ) {
              for (const iterator of val.values[id].value.images) {
                if (iterator.hasOwnProperty("url")) {
                  return iterator.url;
                }
              }
            }
          }
        }
      }
    }
  }

function isVisible(e) {
  return !!( e.offsetWidth || e.offsetHeight || e.getClientRects().length );
}

  window.mwApoInit  = window.mwApoInit  || {};
  window.mwApoInit.onEvent = function (event, args) {  
    if (event == "init::finish") {
      mws_apo_hide_our_variants(
        ".selector-wrapper",
        ".single-option-selector option"
      );

	let swatches = document.querySelectorAll('.mw-option--type-swatch .mw-option__value');
      swatches.forEach(element => {
        if (!isVisible(element)) {
          element.classList.add('mw-hidden')
     }

      if (document.querySelector(".shopify-payment-button")) {
        document.querySelector(".shopify-payment-button").style.display = "none";

        var mutationObserver = new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            document.querySelector(".shopify-payment-button").style.display =
              "none";
          });
        });

        mutationObserver.observe(
          document.getElementsByClassName("shopify-payment-button")[0],
          {
            attributes: true,
            characterData: true,
            childList: true,
            subtree: true,
            attributeOldValue: true,
            characterDataOldValue: true,
          }
        );
      }
    }
  };
  
window.mwApoInit.onCallback = function (event, data) {
  if (event == "applyAttributeStateToHtml::price") {
    $(".grid-item .product__image-wrapper_original_position .forOverlay").attr(
      "style",
      "display: none"
    );

    $(".mw-option__value--selected:not(.mw-hidden)").each(function (
      index,
      element
    ) {
      var $this = $(this);
      var selected = $this.attr("data-value-id");
      const image = imageElement(selected);
      if (typeof image !== "undefined") {
        $(
          ".grid-item .product__image-wrapper_original_position .forOverlay"
        ).each(function (i, el) {
          var $el = $(el);
          if ($el.attr("srcset") === image) {
            $el.removeAttr("style");
          }
        });
      }
    });
  }
  return data;
};

  window.mwApoInit.settings.selectors.product.gallery_container = '.custom_selector';
}
</script>

<style>
  .mw-option__swatch-color {
  	display: block !important;
    
  }
</style>

